Starting VQ-VAE training on healthy data...
Epoch 1/500, Loss: 4801.956590472624
Epoch 2/500, Loss: 3785.5459836762525
Epoch 3/500, Loss: 1249.2587974811422
Epoch 4/500, Loss: 709.2333289837015
Epoch 5/500, Loss: 429.30907808501144
Epoch 6/500, Loss: 238.14112262068124
Epoch 7/500, Loss: 118.8096660745555
Epoch 8/500, Loss: 63.92269121367356
Epoch 9/500, Loss: 45.48395104243838
Epoch 10/500, Loss: 35.12357920613782
Epoch 11/500, Loss: 29.06713212769607
Epoch 12/500, Loss: 23.20152259695119
Epoch 13/500, Loss: 18.855577551085375
Epoch 14/500, Loss: 15.575298358654154
Epoch 15/500, Loss: 13.35773833866777
Epoch 16/500, Loss: 11.897183303175302
Epoch 17/500, Loss: 10.381631826532297
Epoch 18/500, Loss: 9.531930516506064
Epoch 19/500, Loss: 8.256558175744681
Epoch 20/500, Loss: 7.363483930456227
Epoch 21/500, Loss: 6.651915903749137
Epoch 22/500, Loss: 5.944760408894769
Epoch 23/500, Loss: 5.253501555015301
Epoch 24/500, Loss: 4.74821472373502
Epoch 25/500, Loss: 4.273394031771298
Epoch 26/500, Loss: 3.8730308166865646
Epoch 27/500, Loss: 3.8005957829541175
Epoch 28/500, Loss: 3.4030965073355315
Epoch 29/500, Loss: 3.0627990056728494
Epoch 30/500, Loss: 2.871833680004909
Epoch 31/500, Loss: 6.334239793234858
Epoch 32/500, Loss: 6.056843874783351
Epoch 33/500, Loss: 3.519704385050412
Epoch 34/500, Loss: 2.996668889604766
Epoch 35/500, Loss: 2.6024813898678483
Epoch 36/500, Loss: 2.440180099216001
Epoch 37/500, Loss: 2.26253549497703
Epoch 38/500, Loss: 2.023285555428472
Epoch 39/500, Loss: 1.9162320957101624
Epoch 40/500, Loss: 1.9002437488786106
Epoch 41/500, Loss: 1.7542544541687801
Epoch 42/500, Loss: 1.659089712233379
Epoch 43/500, Loss: 1.5716344714164734
Epoch 44/500, Loss: 1.5892361443618248
Epoch 45/500, Loss: 1.48154593644471
Epoch 46/500, Loss: 1.410820608508998
Epoch 47/500, Loss: 1.372025134748426
Epoch 48/500, Loss: 1.3633383466251965
Epoch 49/500, Loss: 1.2970068634584033
Epoch 50/500, Loss: 1.2962538214593098
Epoch 51/500, Loss: 1.3391018175873264
Epoch 52/500, Loss: 1.2753146131490838
Epoch 53/500, Loss: 1.3281230695288757
Epoch 54/500, Loss: 1.2849804830962215
Epoch 55/500, Loss: 1.2089322430306468
Epoch 56/500, Loss: 1.147740666208596
Epoch 57/500, Loss: 2.440393136493091
Epoch 58/500, Loss: 3.8071209243659316
Epoch 59/500, Loss: 1.7932206382011544
Epoch 60/500, Loss: 1.3863662948896145
Epoch 61/500, Loss: 1.102650810932291
Epoch 62/500, Loss: 1.0106080482745994
Epoch 63/500, Loss: 0.9344603707050455
Epoch 64/500, Loss: 0.9124290316269316
Epoch 65/500, Loss: 0.8429721629825132
Epoch 66/500, Loss: 0.8503806472852312
Epoch 67/500, Loss: 0.8630404996460882
Epoch 68/500, Loss: 0.8667113693623707
Epoch 69/500, Loss: 0.8594911699665004
Epoch 70/500, Loss: 0.8260639926482891
Epoch 71/500, Loss: 0.805561953577502
Epoch 72/500, Loss: 0.7835324324410537
Epoch 73/500, Loss: 0.9064367834863991
Epoch 74/500, Loss: 5.1966574931966845
Epoch 75/500, Loss: 1.5073138285299827
Epoch 76/500, Loss: 1.0755233291921944
Epoch 77/500, Loss: 0.914100127487347
Epoch 78/500, Loss: 0.8472578890364746
Epoch 79/500, Loss: 0.7576656303015249
Epoch 80/500, Loss: 0.978467356028228
Epoch 81/500, Loss: 0.7304033626770151
Epoch 82/500, Loss: 0.726313898532555
Epoch 83/500, Loss: 0.6551978295219356
Epoch 84/500, Loss: 0.6488470954113993
Epoch 85/500, Loss: 0.6783286564309021
Epoch 86/500, Loss: 0.6071841747596346
Epoch 87/500, Loss: 0.6104776455924429
Epoch 88/500, Loss: 0.5798052685527966
Epoch 89/500, Loss: 0.5451874635342894
Epoch 90/500, Loss: 0.532980725683015
Epoch 91/500, Loss: 0.519310284534405
Epoch 92/500, Loss: 0.5273106136712534
Epoch 93/500, Loss: 0.47756539901782724
Epoch 94/500, Loss: 1.1219839546187171
Epoch 95/500, Loss: 0.7477320126932243
Epoch 96/500, Loss: 0.5865099401823406
Epoch 97/500, Loss: 0.5169518047879482
Epoch 98/500, Loss: 0.534894400629504
Epoch 99/500, Loss: 0.49381078265864276
Epoch 100/500, Loss: 0.4732564438519807
Epoch 101/500, Loss: 0.44472572592825727
Epoch 102/500, Loss: 0.4344518431301775
Epoch 103/500, Loss: 0.4629566389425048
Epoch 104/500, Loss: 0.4203249437027964
Epoch 105/500, Loss: 0.451176506435049
Epoch 106/500, Loss: 0.4393539300252651
Epoch 107/500, Loss: 0.41588493256733333
Epoch 108/500, Loss: 0.4040937161651151
Epoch 109/500, Loss: 0.3830796643320856
Epoch 110/500, Loss: 0.3991375719678813
Epoch 111/500, Loss: 0.39893608899979754
Epoch 112/500, Loss: 1.1059647762569889
Epoch 113/500, Loss: 0.5625764773837452
Epoch 114/500, Loss: 0.5269277527414519
Epoch 115/500, Loss: 0.44566976356095284
Epoch 116/500, Loss: 0.40342906066055956
Epoch 117/500, Loss: 0.40234382553347225
Epoch 118/500, Loss: 0.3841170558127864
Epoch 119/500, Loss: 0.38554007842622956
Epoch 120/500, Loss: 0.37164023158879117
Epoch 121/500, Loss: 0.36122244737785436
Epoch 122/500, Loss: 0.3623362793747721
Epoch 123/500, Loss: 0.3496690167692201
Epoch 124/500, Loss: 0.34438575380321207
Epoch 125/500, Loss: 0.3741017174104164
Epoch 126/500, Loss: 0.3446244828659913
Epoch 127/500, Loss: 0.3675818495966237
Epoch 128/500, Loss: 0.34566999920483293
Epoch 129/500, Loss: 0.3351560376327613
Epoch 130/500, Loss: 0.32805342985124425
Epoch 131/500, Loss: 0.3350788878983465
Epoch 132/500, Loss: 0.3449473610982813
Epoch 133/500, Loss: 0.3306248975468093
Epoch 134/500, Loss: 0.34522819441967995
Epoch 135/500, Loss: 0.5480866333277061
Epoch 136/500, Loss: 0.40789193120496026
Epoch 137/500, Loss: 0.3699383933482499
Epoch 138/500, Loss: 0.3480599080694133
Epoch 139/500, Loss: 0.3294598140336316
Epoch 140/500, Loss: 0.3336748417852254
Epoch 141/500, Loss: 0.31845625194496124
Epoch 142/500, Loss: 0.30234566266680585
Epoch 143/500, Loss: 0.32090373041814774
Epoch 144/500, Loss: 0.6716393399341353
Epoch 145/500, Loss: 0.7371192913630913
Epoch 146/500, Loss: 0.5104284975035437
Epoch 147/500, Loss: 0.5052170948735599
Epoch 148/500, Loss: 0.41591671828565924
Epoch 149/500, Loss: 0.376908162287597
Epoch 150/500, Loss: 0.35457607011856707
Epoch 151/500, Loss: 0.3380606472492218
Epoch 152/500, Loss: 0.3268852962245201
Epoch 153/500, Loss: 0.31919495311790497
Epoch 154/500, Loss: 0.31233253882362927
Epoch 155/500, Loss: 0.307318530848314
Epoch 156/500, Loss: 0.30136646060594197
Epoch 157/500, Loss: 0.2974534601230046
Epoch 158/500, Loss: 0.29354930463536033
Epoch 159/500, Loss: 0.2904050738133233
Epoch 160/500, Loss: 0.28717664500762674
Epoch 161/500, Loss: 0.2838744130627862
Epoch 162/500, Loss: 0.2833377631573841
Epoch 163/500, Loss: 0.2803621257430521
Epoch 164/500, Loss: 0.2772741438499812
Epoch 165/500, Loss: 0.2752636450118032
Epoch 166/500, Loss: 0.2741006066829994
Epoch 167/500, Loss: 0.2710177857300331
Epoch 168/500, Loss: 0.27380795404314995
Epoch 169/500, Loss: 0.26922668490944235
Epoch 170/500, Loss: 0.30321450518636867
Epoch 171/500, Loss: 0.27156071467646237
Epoch 172/500, Loss: 0.2726115247812764
Epoch 173/500, Loss: 0.27347195341155445
Epoch 174/500, Loss: 0.2685426972035704
Epoch 175/500, Loss: 0.26007956587548914
Epoch 176/500, Loss: 0.2674538495725599
Epoch 177/500, Loss: 0.25870873612062684
Epoch 178/500, Loss: 0.26640282584161595
Epoch 179/500, Loss: 0.2580118661039862
Epoch 180/500, Loss: 0.26425980018644496
Epoch 181/500, Loss: 0.25424379996698476
Epoch 182/500, Loss: 0.26196580714192885
Epoch 183/500, Loss: 0.25601674385111906
Epoch 184/500, Loss: 0.25984383297377617
Epoch 185/500, Loss: 0.25324375336540156
Epoch 186/500, Loss: 0.26817416566713104
Epoch 187/500, Loss: 0.2603822599711089
Epoch 188/500, Loss: 0.25624592152648956
Epoch 189/500, Loss: 0.2552366877167389
Epoch 190/500, Loss: 0.25586218630959245
Epoch 191/500, Loss: 0.2526456792036007
Epoch 192/500, Loss: 0.254000268619636
Epoch 193/500, Loss: 0.2531018627100977
Epoch 194/500, Loss: 1.0110097652108505
Epoch 195/500, Loss: 0.7022930316883942
Epoch 196/500, Loss: 0.42868643048508415
Epoch 197/500, Loss: 0.35571103183359937
Epoch 198/500, Loss: 0.31925862321052056
Epoch 199/500, Loss: 0.3061782929660945
Epoch 200/500, Loss: 0.29436751172460357
Epoch 201/500, Loss: 0.28496828726653395
Epoch 202/500, Loss: 0.2750793894560173
Epoch 203/500, Loss: 0.2783839935115699
Epoch 204/500, Loss: 0.30070170040788324
Epoch 205/500, Loss: 0.2820719077155508
Epoch 206/500, Loss: 0.27151832279974014
Epoch 207/500, Loss: 0.2699185385015504
Epoch 208/500, Loss: 0.26346714948785716
Epoch 209/500, Loss: 0.26127464349927576
Epoch 210/500, Loss: 0.25594597836506777
Epoch 211/500, Loss: 0.25939453560216674
Epoch 212/500, Loss: 0.2555200643837452
Epoch 213/500, Loss: 0.25745369404040536
Epoch 214/500, Loss: 0.2530573236531225
Epoch 215/500, Loss: 0.2565843230434533
Epoch 216/500, Loss: 0.2551977445596251
Epoch 217/500, Loss: 0.2583726964377124
Epoch 218/500, Loss: 0.2525046659183913
Epoch 219/500, Loss: 0.2620697896285304
Epoch 220/500, Loss: 0.2659533303873292
Epoch 221/500, Loss: 0.2595790849420531
Epoch 222/500, Loss: 0.2527110619020873
Epoch 223/500, Loss: 0.27580625242714224
Epoch 224/500, Loss: 0.26256069643744107
Epoch 225/500, Loss: 0.2558647559891487
Epoch 226/500, Loss: 0.2519120879728219
Epoch 227/500, Loss: 0.25405622980204123
Epoch 228/500, Loss: 0.2491582671886888
Epoch 229/500, Loss: 0.2513603113334754
Epoch 230/500, Loss: 0.24810918189328293
Epoch 231/500, Loss: 0.25799807623542587
Epoch 232/500, Loss: 0.25013433795036943
Epoch 233/500, Loss: 0.25294225239034357
Epoch 234/500, Loss: 0.24582780306709223
Epoch 235/500, Loss: 0.2483837410550693
Epoch 236/500, Loss: 0.948367485969231
Epoch 237/500, Loss: 0.731568963877086
Epoch 238/500, Loss: 0.6187700146231158
Epoch 239/500, Loss: 0.4409197389051832
Epoch 240/500, Loss: 0.3830850784634722
Epoch 241/500, Loss: 0.3462664541499368
Epoch 242/500, Loss: 0.3252874828618148
Epoch 243/500, Loss: 0.30831008661409903
Epoch 244/500, Loss: 0.295315014904943
Epoch 245/500, Loss: 0.2921427722121107
Epoch 246/500, Loss: 0.28313118399217213
Epoch 247/500, Loss: 0.28372088909663
Epoch 248/500, Loss: 0.2748161635265268
Epoch 249/500, Loss: 0.27496940192991287
Epoch 250/500, Loss: 0.2719549869411978
Epoch 251/500, Loss: 0.27033568019496984
Epoch 252/500, Loss: 0.25923133089110767
Epoch 253/500, Loss: 0.2665595805336689
Epoch 254/500, Loss: 0.2637653165850146
Epoch 255/500, Loss: 0.25688918345961076
Epoch 256/500, Loss: 0.2563911522256917
Epoch 257/500, Loss: 0.25857822211651965
Epoch 258/500, Loss: 0.2541543622982913
Epoch 259/500, Loss: 0.2581527979466422
Epoch 260/500, Loss: 0.2485422368707328
Epoch 261/500, Loss: 0.25949260386927375
Epoch 262/500, Loss: 0.2507941036902625
Epoch 263/500, Loss: 0.2556698626742281
Epoch 264/500, Loss: 0.250881839543581
Epoch 265/500, Loss: 0.25311344091234533
Epoch 266/500, Loss: 0.2514978940116948
Epoch 267/500, Loss: 0.25171876724424036
Epoch 268/500, Loss: 0.25417930016229895
Epoch 269/500, Loss: 0.2557122356675822
Epoch 270/500, Loss: 0.25071439660828687
Epoch 271/500, Loss: 0.2607524253684899
Epoch 272/500, Loss: 0.24746260676404525
Epoch 273/500, Loss: 0.25743537164967634
Epoch 274/500, Loss: 0.24909716407800542
Epoch 275/500, Loss: 0.25216508489744416
Epoch 276/500, Loss: 0.24808608406576618
Epoch 277/500, Loss: 0.252032649542751
Epoch 278/500, Loss: 0.24880812252903806
Epoch 279/500, Loss: 0.25092665555662125
Epoch 280/500, Loss: 0.24684834955581303
Epoch 281/500, Loss: 0.25149868698469524
Epoch 282/500, Loss: 0.2502963702226507
Epoch 283/500, Loss: 0.2496672271397607
Epoch 284/500, Loss: 0.25011112245506256
Epoch 285/500, Loss: 0.2607183591302099
Epoch 286/500, Loss: 0.2522203667924322
Epoch 287/500, Loss: 0.2565974860355772
Epoch 288/500, Loss: 0.2482581015290885
Epoch 289/500, Loss: 0.720190931496949
Epoch 290/500, Loss: 0.4788048210842856
Epoch 291/500, Loss: 0.36402105514345495
Epoch 292/500, Loss: 0.3140510720168722
Epoch 293/500, Loss: 0.2971279452843913
Epoch 294/500, Loss: 0.28117674589157104
Epoch 295/500, Loss: 0.2774575510672454
Epoch 296/500, Loss: 0.26613750873968517
Epoch 297/500, Loss: 0.2783983523218796
Epoch 298/500, Loss: 0.2581577644009015
Epoch 299/500, Loss: 0.27925140911649016
Epoch 300/500, Loss: 0.26011813162215824
Epoch 301/500, Loss: 0.2712307117622474
Epoch 302/500, Loss: 0.2551357324781089
Epoch 303/500, Loss: 0.2577058535454602
Epoch 304/500, Loss: 0.2554701665609047
Epoch 305/500, Loss: 0.2556886347974169
Epoch 306/500, Loss: 0.25324986309840763
Epoch 307/500, Loss: 0.2538574494678399
Epoch 308/500, Loss: 0.2546858976370302
Epoch 309/500, Loss: 0.24939218009340353
Epoch 310/500, Loss: 0.2516387566153345
Epoch 311/500, Loss: 0.2531496761687871
Epoch 312/500, Loss: 0.2514383036257892
Epoch 313/500, Loss: 0.2525807247850402
Epoch 314/500, Loss: 0.253572681340678
Epoch 315/500, Loss: 0.25055501622886495
Epoch 316/500, Loss: 0.25371557011686524
Epoch 317/500, Loss: 0.25257186116329555
Epoch 318/500, Loss: 0.25193099806021
Epoch 319/500, Loss: 0.2575254034379433
Epoch 320/500, Loss: 0.24889122373585043
Epoch 321/500, Loss: 0.4976382937667699
Epoch 322/500, Loss: 0.41170065092115565
Epoch 323/500, Loss: 0.2817185805018606
Epoch 324/500, Loss: 0.28587956919238483
Epoch 325/500, Loss: 0.27206768493714006
Epoch 326/500, Loss: 0.2658417012927861
Epoch 327/500, Loss: 0.26286937578998765
Epoch 328/500, Loss: 0.2604536948532894
Epoch 329/500, Loss: 0.25628194110146885
Epoch 330/500, Loss: 0.2574245415884873
Epoch 331/500, Loss: 0.25634689539157113
Epoch 332/500, Loss: 0.2537667627992301
Epoch 333/500, Loss: 0.2596447887862551
Epoch 334/500, Loss: 0.255840083391502
Epoch 335/500, Loss: 0.2565447284743704
Epoch 336/500, Loss: 0.2534549463668774
Epoch 337/500, Loss: 0.2614826566443361
Epoch 338/500, Loss: 0.251850881838593
Epoch 339/500, Loss: 0.26176449810636454
Epoch 340/500, Loss: 0.2528187768726513
Epoch 341/500, Loss: 0.26009740449231245
Epoch 342/500, Loss: 0.2557132477904188
Epoch 343/500, Loss: 0.2586621169386239
Epoch 344/500, Loss: 0.2533512973579867
Epoch 345/500, Loss: 0.2630369209780775
Epoch 346/500, Loss: 0.25391802217425974
Epoch 347/500, Loss: 0.2634464318639246
Epoch 348/500, Loss: 0.25227741074973137
Epoch 349/500, Loss: 0.2677825140798914
Epoch 350/500, Loss: 0.2630636965663269
Epoch 351/500, Loss: 0.26450795641747016
Epoch 352/500, Loss: 0.2592403531588357
Epoch 353/500, Loss: 0.27229748139607496
Epoch 354/500, Loss: 0.26842213601901616
Epoch 355/500, Loss: 0.26625984470392094
Epoch 356/500, Loss: 0.2682740507197791
Epoch 357/500, Loss: 0.2889271700947449
Epoch 358/500, Loss: 0.2607711076993367
Epoch 359/500, Loss: 0.26886337533079346
Epoch 360/500, Loss: 0.26277065482632866
Epoch 361/500, Loss: 0.26816146718016987
Epoch 362/500, Loss: 0.26132481686514
Epoch 363/500, Loss: 0.26805405023282974
Epoch 364/500, Loss: 0.2679765450543371
Epoch 365/500, Loss: 0.26712363123379906
Epoch 366/500, Loss: 0.2625469809462284
Epoch 367/500, Loss: 0.2698046259325126
Epoch 368/500, Loss: 0.2643024888018082
Epoch 369/500, Loss: 0.2715500021546051
Epoch 370/500, Loss: 0.2653030877740219
Epoch 371/500, Loss: 0.2711978317077818
Epoch 372/500, Loss: 0.26603317376354646
Epoch 373/500, Loss: 0.2729559588278162
Epoch 374/500, Loss: 0.27009438286567555
Epoch 375/500, Loss: 0.2704609478342122
Epoch 376/500, Loss: 0.2694498674365981
Epoch 377/500, Loss: 0.27556369723430996
Epoch 378/500, Loss: 0.2702325826575016
Epoch 379/500, Loss: 0.2747170663085477
Epoch 380/500, Loss: 0.2710721133084133
Epoch 381/500, Loss: 0.27765144895890664
Epoch 382/500, Loss: 0.27392266639347734
Epoch 383/500, Loss: 0.27447842973573455
Epoch 384/500, Loss: 0.2769376948989671
Epoch 385/500, Loss: 0.2958841810709444
Epoch 386/500, Loss: 0.27619580397831983
Epoch 387/500, Loss: 0.28059362799956883
Epoch 388/500, Loss: 0.2786356304483167
Epoch 389/500, Loss: 0.27997988629443893
Epoch 390/500, Loss: 0.2777392430038288
Epoch 391/500, Loss: 0.28092177482000713
Epoch 392/500, Loss: 0.27846663676459216
Epoch 393/500, Loss: 0.28039142527970773
Epoch 394/500, Loss: 0.2785178628461114
Epoch 395/500, Loss: 0.29550129522023527
Epoch 396/500, Loss: 0.2822751470937811
Epoch 397/500, Loss: 0.28168193250894547
Epoch 398/500, Loss: 0.28153816315120667
Epoch 399/500, Loss: 0.2826744732928687
Epoch 400/500, Loss: 0.2846892041892841
Epoch 401/500, Loss: 0.28141995146870613
Epoch 402/500, Loss: 0.2856500281085228
Epoch 403/500, Loss: 0.282618658681368
Epoch 404/500, Loss: 0.28549495467851904
Epoch 405/500, Loss: 0.2842116255698533
Epoch 406/500, Loss: 0.2912411807939924
Epoch 407/500, Loss: 0.2841829873364547
Epoch 408/500, Loss: 0.2994307242333889
Epoch 409/500, Loss: 0.2853291006437663
Epoch 410/500, Loss: 0.29203038187376384
Epoch 411/500, Loss: 0.28953339647630166
Epoch 412/500, Loss: 0.28995603412903587
Epoch 413/500, Loss: 0.28438720659449185
Epoch 414/500, Loss: 0.2931426186756841
Epoch 415/500, Loss: 0.28919341370206453
Epoch 416/500, Loss: 0.29107813575658303
Epoch 417/500, Loss: 0.2905564680695534
Epoch 418/500, Loss: 0.2900933136456999
Epoch 419/500, Loss: 0.2902365628758381
Epoch 420/500, Loss: 0.2921422436062632
Epoch 421/500, Loss: 0.28959703586738683
Epoch 422/500, Loss: 0.29683115127785453
Epoch 423/500, Loss: 0.28815147293538884
Epoch 424/500, Loss: 0.2961262495353304
Epoch 425/500, Loss: 0.2892625552826914
Epoch 426/500, Loss: 0.30098934188998977
Epoch 427/500, Loss: 0.29199320938566636
Epoch 428/500, Loss: 0.30318210376747723
Epoch 429/500, Loss: 0.29164876480554713
Epoch 430/500, Loss: 0.29288651691428547
Epoch 431/500, Loss: 0.29596538070974676
Epoch 432/500, Loss: 0.2970953179073745
Epoch 433/500, Loss: 0.29352583068198174
Epoch 434/500, Loss: 0.4341585219934069
Epoch 435/500, Loss: 0.31153346996369036
Epoch 436/500, Loss: 0.31472905442632476
Epoch 437/500, Loss: 0.2980129337259408
Epoch 438/500, Loss: 0.30328990390588495
Epoch 439/500, Loss: 0.30068212259432364
Epoch 440/500, Loss: 0.30335301854487123
Epoch 441/500, Loss: 0.3003744912044755
Epoch 442/500, Loss: 0.2990349517043295
Epoch 443/500, Loss: 0.2967284386014116
Epoch 444/500, Loss: 0.2996449787811986
Epoch 445/500, Loss: 0.2965268414339115
Epoch 446/500, Loss: 0.29544410070982474
Epoch 447/500, Loss: 0.29714273301691846
Epoch 448/500, Loss: 0.2980556842581979
Epoch 449/500, Loss: 0.2987695824483345
Epoch 450/500, Loss: 0.3026898202711138
Epoch 451/500, Loss: 0.29876450539149085
Epoch 452/500, Loss: 0.30018151089035233
Epoch 453/500, Loss: 0.29866298223877774
Epoch 454/500, Loss: 0.2992905166385503
Epoch 455/500, Loss: 0.29682788496901247
Epoch 456/500, Loss: 0.3007697257502326
Epoch 457/500, Loss: 0.3008385841445676
Epoch 458/500, Loss: 0.3014754304855034
Epoch 459/500, Loss: 0.3005254800463545
Epoch 460/500, Loss: 0.3010573324201436
Epoch 461/500, Loss: 0.3004109679624952
Epoch 462/500, Loss: 0.4116507159738705
Epoch 463/500, Loss: 0.3550955976905494
Epoch 464/500, Loss: 0.3237707685550739
Epoch 465/500, Loss: 0.3147761580245248
Epoch 466/500, Loss: 0.3063373875258298
Epoch 467/500, Loss: 0.31396662675101183
Epoch 468/500, Loss: 0.30339912209531356
Epoch 469/500, Loss: 0.3088065307458927
Epoch 470/500, Loss: 0.3015736512325961
Epoch 471/500, Loss: 0.3056665100157261
Epoch 472/500, Loss: 0.3007830989001126
Epoch 473/500, Loss: 0.30634961290092305
Epoch 474/500, Loss: 0.3037474438034255
Epoch 475/500, Loss: 0.302589649398779
Epoch 476/500, Loss: 0.3025091018142371
Epoch 477/500, Loss: 0.31514367307054586
Epoch 478/500, Loss: 0.30365993544973174
Epoch 479/500, Loss: 0.3053432851387509
Epoch 480/500, Loss: 0.30252967196805725
Epoch 481/500, Loss: 0.30577317753742483
Epoch 482/500, Loss: 0.3038494996726513
Epoch 483/500, Loss: 0.3058808492175464
Epoch 484/500, Loss: 0.30112939559180163
Epoch 485/500, Loss: 0.31172720831016015
Epoch 486/500, Loss: 0.3075377698345431
Epoch 487/500, Loss: 0.30779033860769767
Epoch 488/500, Loss: 0.30255059820824654
Epoch 489/500, Loss: 0.30672890191961977
Epoch 490/500, Loss: 0.30431409552693367
Epoch 491/500, Loss: 0.3086798616267484
Epoch 492/500, Loss: 0.30779072886397096
Epoch 493/500, Loss: 0.3081806566694687
Epoch 494/500, Loss: 0.3101737993801462
Epoch 495/500, Loss: 0.31126396910383786
Epoch 496/500, Loss: 0.30952618682178956
Epoch 497/500, Loss: 0.31138473762006597
Epoch 498/500, Loss: 0.3079125575464347
Epoch 499/500, Loss: 0.31454755674148427
Epoch 500/500, Loss: 0.30994389976920755
Model saved to /home/agoyal19/My_Work/Healing_Model/Healthy_Models/healthy_vqvae.pth
VQ-VAE training completed.
Starting DDPM training on latent representations from VQ-VAE...
Traceback (most recent call last):
  File "/home/agoyal19/My_Work/Healing_Model/VQVAE-DDPM/DDPM_Training.py", line 49, in <module>
    z_noisy = ddpm_model.q_sample(z, t)
  File "/home/agoyal19/My_Work/Healing_Model/VQVAE-DDPM/DDPM_Implementation.py", line 66, in q_sample
    return (self.sqrt_alphas_cumprod[t] * x_start + self.sqrt_one_minus_alphas_cumprod[t] * noise)
  File "/home/agoyal19/anaconda3/envs/seg/lib/python3.8/site-packages/torch/_tensor.py", line 1030, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
DDPM training completed.
Starting lesion healing and reconstruction with VQ-VAE and DDPM...
Loaded 578 files from /home/agoyal19/Dataset/Dataset_Full/images
Traceback (most recent call last):
  File "/home/agoyal19/My_Work/Healing_Model/VQVAE-DDPM/Lesion_Healing_VAE_with_DDPM.py", line 52, in <module>
    z_noisy = ddpm_model.q_sample(z, t=torch.randint(0, ddpm_model.num_timesteps, (z.size(0),), device=device).long())
  File "/home/agoyal19/My_Work/Healing_Model/VQVAE-DDPM/DDPM_Implementation.py", line 66, in q_sample
    return (self.sqrt_alphas_cumprod[t] * x_start + self.sqrt_one_minus_alphas_cumprod[t] * noise)
  File "/home/agoyal19/anaconda3/envs/seg/lib/python3.8/site-packages/torch/_tensor.py", line 1030, in __array__
    return self.numpy()
TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
Lesion healing and reconstruction completed.
Starting comparison of original and reconstructed images...
No corresponding file found for 2662_8797322952_ct.nii.gz
No corresponding file found for 2663_3652734274_ct.nii.gz
No corresponding file found for 2466_3294437236_ct.nii.gz
No corresponding file found for 2538_3367098122_ct.nii.gz
No corresponding file found for 2250_3398157536_ct.nii.gz
No corresponding file found for 2356_1816582544_ct.nii.gz
No corresponding file found for 2488_2262220363_ct.nii.gz
No corresponding file found for 2365_5011748479_ct.nii.gz
No corresponding file found for 2589_3389945183_ct.nii.gz
No corresponding file found for 2638_1634566566_ct.nii.gz
No corresponding file found for 2262_3233827331_ct.nii.gz
No corresponding file found for 2490_8361455010_ct.nii.gz
No corresponding file found for 2666_1952913604_ct.nii.gz
No corresponding file found for 2669_1443109235_ct.nii.gz
No corresponding file found for 2717_2974869217_ct.nii.gz
No corresponding file found for 2511_7748937238_ct.nii.gz
No corresponding file found for 2404_1540277513_ct.nii.gz
No corresponding file found for 2543_2894800801_ct.nii.gz
No corresponding file found for 2300_1109689758_ct.nii.gz
No corresponding file found for 2417_2535096532_ct.nii.gz
No corresponding file found for 2534_1889987918_ct.nii.gz
No corresponding file found for 2378_3876451394_ct.nii.gz
No corresponding file found for 2402_1511097630_ct.nii.gz
No corresponding file found for 2386_1583316811_ct.nii.gz
No corresponding file found for 2535_9324685971_ct.nii.gz
No corresponding file found for 2700_2514234346_ct.nii.gz
No corresponding file found for 2544_3238972517_ct.nii.gz
No corresponding file found for 2452_1469111226_ct.nii.gz
No corresponding file found for 2691_3247450148_ct.nii.gz
No corresponding file found for 2329_1317555555_ct.nii.gz
No corresponding file found for 2629_1998180782_ct.nii.gz
No corresponding file found for 2362_2086466981_ct.nii.gz
No corresponding file found for 2297_5482867529_ct.nii.gz
No corresponding file found for 2596_3172035407_ct.nii.gz
No corresponding file found for 2301_1090672398_ct.nii.gz
No corresponding file found for 2552_2923313470_ct.nii.gz
No corresponding file found for 2724_1110778744_ct.nii.gz
No corresponding file found for 2344_1784693666_ct.nii.gz
No corresponding file found for 2460_3329191953_ct.nii.gz
No corresponding file found for 2461_2767934036_ct.nii.gz
No corresponding file found for 2343_2898251269_ct.nii.gz
No corresponding file found for 2352_2745484568_ct.nii.gz
No corresponding file found for 2437_6841614189_ct.nii.gz
No corresponding file found for 2621_2598965783_ct.nii.gz
No corresponding file found for 2592_7804356343_ct.nii.gz
No corresponding file found for 2643_1666973011_ct.nii.gz
No corresponding file found for 2224_2564111995_ct.nii.gz
No corresponding file found for 2327_2754984454_ct.nii.gz
No corresponding file found for 2395_2969430364_ct.nii.gz
No corresponding file found for 2332_1332810907_ct.nii.gz
No corresponding file found for 2654_4804852375_ct.nii.gz
No corresponding file found for 2278_6799124093_ct.nii.gz
No corresponding file found for 2480_1623205057_ct.nii.gz
No corresponding file found for 2302_5202280354_ct.nii.gz
No corresponding file found for 2359_1143641672_ct.nii.gz
No corresponding file found for 2398_9065013941_ct.nii.gz
No corresponding file found for 2227_2339850822_ct.nii.gz
No corresponding file found for 2393_1579978364_ct.nii.gz
No corresponding file found for 2472_1401034787_ct.nii.gz
No corresponding file found for 2558_2600679528_ct.nii.gz
No corresponding file found for 2416_5966879525_ct.nii.gz
No corresponding file found for 2720_1407821446_ct.nii.gz
No corresponding file found for 2226_2061339079_ct.nii.gz
No corresponding file found for 2665_1277653488_ct.nii.gz
No corresponding file found for 2683_1003443553_ct.nii.gz
No corresponding file found for 2321_1066986767_ct.nii.gz
No corresponding file found for 2595_2315387681_ct.nii.gz
No corresponding file found for 2436_9697792254_ct.nii.gz
No corresponding file found for 2467_5848318514_ct.nii.gz
No corresponding file found for 2392_3387008770_ct.nii.gz
No corresponding file found for 2432_3338125403_ct.nii.gz
No corresponding file found for 2426_2147877392_ct.nii.gz
No corresponding file found for 2324_1047084599_ct.nii.gz
No corresponding file found for 2574_9429834720_ct.nii.gz
No corresponding file found for 2235_8257173982_ct.nii.gz
No corresponding file found for 2477_2365258310_ct.nii.gz
No corresponding file found for 2370_2617539245_ct.nii.gz
No corresponding file found for 2639_1492006128_ct.nii.gz
No corresponding file found for 2594_1193594639_ct.nii.gz
No corresponding file found for 2651_7108378507_ct.nii.gz
No corresponding file found for 2619_7747326685_ct.nii.gz
No corresponding file found for 2475_3222867941_ct.nii.gz
No corresponding file found for 2464_1134400670_ct.nii.gz
No corresponding file found for 2653_9003070470_ct.nii.gz
No corresponding file found for 2671_1296617584_ct.nii.gz
No corresponding file found for 2241_1117341842_ct.nii.gz
No corresponding file found for 2347_1406539650_ct.nii.gz
No corresponding file found for 2493_1737811408_ct.nii.gz
No corresponding file found for 2289_1546144185_ct.nii.gz
No corresponding file found for 2465_3393111926_ct.nii.gz
No corresponding file found for 2623_1350376159_ct.nii.gz
No corresponding file found for 2361_2930333975_ct.nii.gz
No corresponding file found for 2566_1329019832_ct.nii.gz
No corresponding file found for 2646_1816150506_ct.nii.gz
Processing complete.
Comparison completed.
All steps have been successfully completed.
